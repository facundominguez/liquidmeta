<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/home/michael/liquidmeta/old/STLC.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE GADTs #-}</span></a>
<span class=hs-linenum>  2: </span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>--{-@ LIQUID "--counter-examples" @-}</span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>--{-@ LIQUID "--exact-data-cons" @-}</span>
<span class=hs-linenum>  5: </span><span class='hs-comment'>--{-@ LIQUID "--higherorder" @-}</span>
<span class=hs-linenum>  6: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--reflection"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  7: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--ple"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  8: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--prune-unsorted"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 10: </span>
<span class=hs-linenum> 11: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>STLC</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 12: </span>
<span class=hs-linenum> 13: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Set</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>S</span>
<span class=hs-linenum> 14: </span>
<span class=hs-linenum> 15: </span><span class='hs-comment'>---------------------------------------------------------------------------</span>
<span class=hs-linenum> 16: </span><span class='hs-comment'>----- | PRELIMINARIES</span>
<span class=hs-linenum> 17: </span><span class='hs-comment'>---------------------------------------------------------------------------</span>
<span class=hs-linenum> 18: </span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>prop</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 20: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ProofOf</span> <span class='hs-conid'>E</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span> <span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>prop</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>E</span> <span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 21: </span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Proof</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 23: </span>
<span class=hs-linenum> 24: </span><span class='hs-comment'>--TODO: will classes and instances make anything easier or harder?</span>
<span class=hs-linenum> 25: </span><span class='hs-comment'>--class HasVars a where</span>
<span class=hs-linenum> 26: </span><span class='hs-comment'>--    free  :: a -&gt; S.Set Vname</span>
<span class=hs-linenum> 27: </span><span class='hs-comment'>--    subst :: Vname -&gt; </span>
<span class=hs-linenum> 28: </span>
<span class=hs-linenum> 29: </span><span class='hs-comment'>---------------------------------------------------------------------------</span>
<span class=hs-linenum> 30: </span><span class='hs-comment'>----- | TERMS of our language</span>
<span class=hs-linenum> 31: </span><span class='hs-comment'>---------------------------------------------------------------------------</span>
<span class=hs-linenum> 32: </span>  <span class='hs-comment'>---   Refinement Level: Names, Terms (in FO), FO Predicates, SMT Formulae</span>
<span class=hs-linenum> 33: </span>
<span class=hs-linenum> 34: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>String</span>
<span class=hs-linenum> 35: </span>
<span class=hs-linenum> 36: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Term</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Ic</span> <span class='hs-conid'>Int</span>                    <span class='hs-comment'>-- 0, 1, ...</span>
<span class=hs-linenum> 37: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Iv</span> <span class='hs-conid'>Vname</span>                  <span class='hs-comment'>-- x, y, z; interpreted over Z</span>
<span class=hs-linenum> 38: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 39: </span>
<span class=hs-linenum> 40: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Bc</span> <span class='hs-conid'>Bool</span>                   <span class='hs-comment'>-- True, False</span>
<span class=hs-linenum> 41: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>And</span> <span class='hs-conid'>Pred</span> <span class='hs-conid'>Pred</span>
<span class=hs-linenum> 42: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Or</span> <span class='hs-conid'>Pred</span> <span class='hs-conid'>Pred</span>
<span class=hs-linenum> 43: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Not</span> <span class='hs-conid'>Pred</span>
<span class=hs-linenum> 44: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Leq</span> <span class='hs-conid'>Term</span> <span class='hs-conid'>Term</span>
<span class=hs-linenum> 45: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Eq</span> <span class='hs-conid'>Term</span> <span class='hs-conid'>Term</span>
<span class=hs-linenum> 46: </span>          <span class='hs-comment'>-- and uninterpreted functions?</span>
<span class=hs-linenum> 47: </span>          <span class='hs-comment'>-- and anything else eneeded? don't seem to need Boolean vars</span>
<span class=hs-linenum> 48: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 49: </span>
<span class=hs-linenum> 50: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Form</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>P</span> <span class='hs-conid'>Pred</span>                    <span class='hs-comment'>-- p</span>
<span class=hs-linenum> 51: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>FAnd</span> <span class='hs-conid'>Form</span> <span class='hs-conid'>Form</span>            <span class='hs-comment'>-- c1 ^ c2</span>
<span class=hs-linenum> 52: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Impl</span> <span class='hs-conid'>Vname</span> <span class='hs-conid'>Base</span> <span class='hs-conid'>Pred</span> <span class='hs-conid'>Form</span> <span class='hs-comment'>-- \forall x:b. p =&gt; c</span>
<span class=hs-linenum> 53: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 54: </span>
<span class=hs-linenum> 55: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>isTermValue</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 56: </span><span class='hs-definition'>isTermValue</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Term</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum> 57: </span><a class=annot href="#"><span class=annottext>x1:STLC.Term -&gt; {VV : GHC.Types.Bool | VV == isTermValue x1}</span><span class='hs-definition'>isTermValue</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Ic</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum> 58: </span><span class='hs-definition'>isTermValue</span> <span class='hs-keyword'>_</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum> 59: </span>
<span class=hs-linenum> 60: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>vars</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 61: </span><span class='hs-definition'>vars</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Term</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>S.Set</span> <span class='hs-conid'>Vname</span>
<span class=hs-linenum> 62: </span><a class=annot href="#"><span class=annottext>x1:STLC.Term -&gt; {VV : (Data.Set.Internal.Set [GHC.Types.Char]) | VV == vars x1}</span><span class='hs-definition'>vars</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Iv</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; {v : (Data.Set.Internal.Set a) | v == Set_sng x1}</span><span class='hs-conid'>S.singleton</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum> 63: </span><span class='hs-definition'>vars</span> <span class='hs-keyword'>_</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
{v : (Data.Set.Internal.Set a) | Set_emp v
                                 &amp;&amp; v == empty}</span><span class='hs-conid'>S.empty</span></a>
<span class=hs-linenum> 64: </span>
<span class=hs-linenum> 65: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>fv</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 66: </span><span class='hs-definition'>fv</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>S.Set</span> <span class='hs-conid'>Vname</span>
<span class=hs-linenum> 67: </span><a class=annot href="#"><span class=annottext>x1:STLC.Pred -&gt; {VV : (Data.Set.Internal.Set [GHC.Types.Char]) | VV == fv x1}</span><span class='hs-definition'>fv</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Bc</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
{v : (Data.Set.Internal.Set a) | Set_emp v
                                 &amp;&amp; v == empty}</span><span class='hs-conid'>S.empty</span></a>
<span class=hs-linenum> 68: </span><span class='hs-definition'>fv</span> <span class='hs-layout'>(</span><span class='hs-conid'>And</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Classes.Ord [GHC.Types.Char]) | v == $dOrd_a3iH}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == fv p1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fv</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p1}</span><span class='hs-varid'>p1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == fv p2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fv</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p2}</span><span class='hs-varid'>p2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 69: </span><span class='hs-definition'>fv</span> <span class='hs-layout'>(</span><span class='hs-conid'>Or</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Classes.Ord [GHC.Types.Char]) | v == $dOrd_a3iH}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == fv p1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fv</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p1}</span><span class='hs-varid'>p1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == fv p2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fv</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p2}</span><span class='hs-varid'>p2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 70: </span><span class='hs-definition'>fv</span> <span class='hs-layout'>(</span><span class='hs-conid'>Not</span> <span class='hs-varid'>p1</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Pred -&gt; {VV : (Data.Set.Internal.Set [GHC.Types.Char]) | VV == fv x1}</span><span class='hs-varid'>fv</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p1}</span><span class='hs-varid'>p1</span></a>
<span class=hs-linenum> 71: </span><span class='hs-definition'>fv</span> <span class='hs-layout'>(</span><span class='hs-conid'>Leq</span> <span class='hs-varid'>t1</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Classes.Ord [GHC.Types.Char]) | v == $dOrd_a3iH}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == vars t1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>vars</span> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t1}</span><span class='hs-varid'>t1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == vars t2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>vars</span> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t2}</span><span class='hs-varid'>t2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 72: </span><span class='hs-definition'>fv</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span>  <span class='hs-varid'>t1</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Classes.Ord [GHC.Types.Char]) | v == $dOrd_a3iH}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == vars t1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>vars</span> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t1}</span><span class='hs-varid'>t1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == vars t2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>vars</span> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t2}</span><span class='hs-varid'>t2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 73: </span>
<span class=hs-linenum> 74: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>bval</span> <span class='hs-keyword'>@-}</span> <span class='hs-comment'>-- only defined if no free vars</span>
<span class=hs-linenum> 75: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>bval</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ p:</span><span class='hs-conid'>Pred</span> <span class='hs-keyword'>| fv p = S.empty }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 76: </span><span class='hs-definition'>bval</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum> 77: </span><a class=annot href="#"><span class=annottext>{p : STLC.Pred | fv p == Set_empty 0} -&gt; GHC.Types.Bool</span><span class='hs-definition'>bval</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Bc</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>                <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == b}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum> 78: </span><span class='hs-definition'>bval</span> <span class='hs-layout'>(</span><span class='hs-conid'>And</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == bval p1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bval</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p1}</span><span class='hs-varid'>p1</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == bval p2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bval</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p2}</span><span class='hs-varid'>p2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 79: </span><span class='hs-definition'>bval</span> <span class='hs-layout'>(</span><span class='hs-conid'>Or</span>  <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == bval p1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bval</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p1}</span><span class='hs-varid'>p1</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == bval p2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bval</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p2}</span><span class='hs-varid'>p2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 80: </span><span class='hs-definition'>bval</span> <span class='hs-layout'>(</span><span class='hs-conid'>Not</span> <span class='hs-varid'>p1</span><span class='hs-layout'>)</span>              <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Bool -&gt; {v : GHC.Types.Bool | v &lt;=&gt; not x1}</span><span class='hs-varid'>not</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == bval p1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bval</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p1}</span><span class='hs-varid'>p1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 81: </span><span class='hs-definition'>bval</span> <span class='hs-layout'>(</span><span class='hs-conid'>Leq</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ic</span> <span class='hs-varid'>n1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ic</span> <span class='hs-varid'>n2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n1}</span><span class='hs-varid'>n1</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n2}</span><span class='hs-varid'>n2</span></a>
<span class=hs-linenum> 82: </span><span class='hs-definition'>bval</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span>  <span class='hs-layout'>(</span><span class='hs-conid'>Ic</span> <span class='hs-varid'>n1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ic</span> <span class='hs-varid'>n2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n1}</span><span class='hs-varid'>n1</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n2}</span><span class='hs-varid'>n2</span></a>
<span class=hs-linenum> 83: </span>
<span class=hs-linenum> 84: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>bsubst</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 85: </span><span class='hs-definition'>bsubst</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Term</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pred</span>
<span class=hs-linenum> 86: </span><a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; x2:STLC.Term -&gt; x3:STLC.Pred -&gt; {VV : STLC.Pred | VV == bsubst x1 x2 x3}</span><span class='hs-definition'>bsubst</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>STLC.Term</span><span class='hs-varid'>t</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Bc</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>             <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Bool -&gt; {v : STLC.Pred | Bc##lqdc##$select v == x1
                                      &amp;&amp; v == Bc x1}</span><span class='hs-conid'>Bc</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == b}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum> 87: </span><span class='hs-definition'>bsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>And</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Pred -&gt; x2:STLC.Pred -&gt; {v : STLC.Pred | And##lqdc##$select v == x2
                                                 &amp;&amp; And##lqdc##$select v == x1
                                                 &amp;&amp; v == And x1 x2}</span><span class='hs-conid'>And</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == bsubst x t p1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p1}</span><span class='hs-varid'>p1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == bsubst x t p2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p2}</span><span class='hs-varid'>p2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 88: </span><span class='hs-definition'>bsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Or</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Pred -&gt; x2:STLC.Pred -&gt; {v : STLC.Pred | Or##lqdc##$select v == x2
                                                 &amp;&amp; Or##lqdc##$select v == x1
                                                 &amp;&amp; v == Or x1 x2}</span><span class='hs-conid'>Or</span></a>  <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == bsubst x t p1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p1}</span><span class='hs-varid'>p1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == bsubst x t p2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p2}</span><span class='hs-varid'>p2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 89: </span><span class='hs-definition'>bsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Not</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Pred -&gt; {v : STLC.Pred | Not##lqdc##$select v == x1
                                 &amp;&amp; v == Not x1}</span><span class='hs-conid'>Not</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == bsubst x t p}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p}</span><span class='hs-varid'>p</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 90: </span><span class='hs-definition'>bsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Leq</span> <span class='hs-varid'>t1</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Term -&gt; x2:STLC.Term -&gt; {v : STLC.Pred | Leq##lqdc##$select v == x2
                                                 &amp;&amp; Leq##lqdc##$select v == x1
                                                 &amp;&amp; v == Leq x1 x2}</span><span class='hs-conid'>Leq</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == tmsubst x t t1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tmsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t1}</span><span class='hs-varid'>t1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == tmsubst x t t2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tmsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t2}</span><span class='hs-varid'>t2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 91: </span><span class='hs-definition'>bsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span>  <span class='hs-varid'>t1</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Term -&gt; x2:STLC.Term -&gt; {v : STLC.Pred | Eq##lqdc##$select v == x2
                                                 &amp;&amp; Eq##lqdc##$select v == x1
                                                 &amp;&amp; v == Eq x1 x2}</span><span class='hs-conid'>Eq</span></a>  <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == tmsubst x t t1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tmsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t1}</span><span class='hs-varid'>t1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == tmsubst x t t2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tmsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | v == t2}</span><span class='hs-varid'>t2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 92: </span>
<span class=hs-linenum> 93: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>tmsubst</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 94: </span><span class='hs-definition'>tmsubst</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Term</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Term</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Term</span>
<span class=hs-linenum> 95: </span><a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; x2:STLC.Term -&gt; x3:STLC.Term -&gt; {VV : STLC.Term | VV == tmsubst x1 x2 x3}</span><span class='hs-definition'>tmsubst</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>x</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Iv</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Iv</span> <span class='hs-varid'>z</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == z}</span><span class='hs-varid'>z</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; {v : STLC.Term | Iv##lqdc##$select v == x1
                                        &amp;&amp; v == Iv x1}</span><span class='hs-conid'>Iv</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == y}</span><span class='hs-varid'>y</span></a>
<span class=hs-linenum> 96: </span>                        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; {v : STLC.Term | Iv##lqdc##$select v == x1
                                        &amp;&amp; v == Iv x1}</span><span class='hs-conid'>Iv</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == z}</span><span class='hs-varid'>z</span></a>
<span class=hs-linenum> 97: </span><span class='hs-definition'>tmsubst</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ic</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Iv</span> <span class='hs-varid'>z</span><span class='hs-layout'>)</span>             <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; {v : STLC.Term | Ic##lqdc##$select v == x1
                                     &amp;&amp; v == Ic x1}</span><span class='hs-conid'>Ic</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n}</span><span class='hs-varid'>n</span></a>
<span class=hs-linenum> 98: </span><span class='hs-definition'>tmsubst</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>_</span>      <span class='hs-layout'>(</span><span class='hs-conid'>Ic</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>             <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; {v : STLC.Term | Ic##lqdc##$select v == x1
                                     &amp;&amp; v == Ic x1}</span><span class='hs-conid'>Ic</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == c}</span><span class='hs-varid'>c</span></a>
<span class=hs-linenum> 99: </span>
<span class=hs-linenum>100: </span><span class='hs-comment'>-- TODO: do i need BEvalsTo in addition to just bval?</span>
<span class=hs-linenum>101: </span>  
<span class=hs-linenum>102: </span>  <span class='hs-comment'>---   Term level expressions </span>
<span class=hs-linenum>103: </span>
<span class=hs-linenum>104: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-conid'>Int</span>                <span class='hs-comment'>-- Constant c</span>
<span class=hs-linenum>105: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>V</span> <span class='hs-conid'>Vname</span>              <span class='hs-comment'>-- x</span>
<span class=hs-linenum>106: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Lambda</span> <span class='hs-conid'>Vname</span> <span class='hs-conid'>Expr</span>    <span class='hs-comment'>-- \x.e</span>
<span class=hs-linenum>107: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>App</span> <span class='hs-conid'>Expr</span> <span class='hs-conid'>Expr</span>        <span class='hs-comment'>-- e e'  TODO or does this become e v ??</span>
<span class=hs-linenum>108: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Let</span> <span class='hs-conid'>Vname</span> <span class='hs-conid'>Expr</span> <span class='hs-conid'>Expr</span>  <span class='hs-comment'>-- let x = e1 in e2</span>
<span class=hs-linenum>109: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Annot</span> <span class='hs-conid'>Expr</span> <span class='hs-conid'>Type</span>      <span class='hs-comment'>-- e : t</span>
<span class=hs-linenum>110: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum>111: </span>
<span class=hs-linenum>112: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>isValue</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>113: </span><span class='hs-definition'>isValue</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>114: </span><a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; {VV : GHC.Types.Bool | VV == isValue x1}</span><span class='hs-definition'>isValue</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum>115: </span><span class='hs-definition'>isValue</span> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum>116: </span><span class='hs-definition'>isValue</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lambda</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum>117: </span><span class='hs-definition'>isValue</span> <span class='hs-keyword'>_</span>            <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum>118: </span>
<span class=hs-linenum>119: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>subst</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>120: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>subst</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ v:</span><span class='hs-conid'>Expr</span> <span class='hs-keyword'>| isValue v }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>121: </span><span class='hs-definition'>subst</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span>
<span class=hs-linenum>122: </span><a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; {v : STLC.Expr | isValue v} -&gt; STLC.Expr -&gt; STLC.Expr</span><span class='hs-definition'>subst</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | isValue v}</span><span class='hs-varid'>v</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>              <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; {v : STLC.Expr | C##lqdc##$select v == x1
                                     &amp;&amp; v == C x1}</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n}</span><span class='hs-varid'>n</span></a>
<span class=hs-linenum>123: </span><span class='hs-definition'>subst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == y}</span><span class='hs-varid'>y</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | isValue v'
                  &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a>
<span class=hs-linenum>124: </span>                <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; {v : STLC.Expr | V##lqdc##$select v == x1
                                        &amp;&amp; v == V x1}</span><span class='hs-conid'>V</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == y}</span><span class='hs-varid'>y</span></a> <span class='hs-comment'>-- TODO ensure no clashes with bound var names</span>
<span class=hs-linenum>125: </span><span class='hs-definition'>subst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lambda</span> <span class='hs-varid'>y</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; x2:STLC.Expr -&gt; {v : STLC.Expr | Lambda##lqdc##$select v == x2
                                                        &amp;&amp; Lambda##lqdc##$select v == x1
                                                        &amp;&amp; v == Lambda x1 x2}</span><span class='hs-conid'>Lambda</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == y}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == subst x v e}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>subst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | isValue v'
                  &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>126: </span><span class='hs-definition'>subst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>e</span> <span class='hs-varid'>v'</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; {v : STLC.Expr | App##lqdc##$select v == x2
                                                 &amp;&amp; App##lqdc##$select v == x1
                                                 &amp;&amp; v == App x1 x2}</span><span class='hs-conid'>App</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == subst x v e}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>subst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | isValue v'
                  &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == subst x v v'}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>subst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | isValue v'
                  &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == v'}</span><span class='hs-varid'>v'</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>127: </span><span class='hs-definition'>subst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Let</span> <span class='hs-varid'>y</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; x2:STLC.Expr -&gt; x3:STLC.Expr -&gt; {v : STLC.Expr | Let##lqdc##$select v == x3
                                                                        &amp;&amp; Let##lqdc##$select v == x2
                                                                        &amp;&amp; Let##lqdc##$select v == x1
                                                                        &amp;&amp; v == Let x1 x2 x3}</span><span class='hs-conid'>Let</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == y}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == subst x v e1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>subst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | isValue v'
                  &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e1}</span><span class='hs-varid'>e1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == subst x v e2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>subst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | isValue v'
                  &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e2}</span><span class='hs-varid'>e2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>128: </span><span class='hs-definition'>subst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Annot</span> <span class='hs-varid'>e</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Type -&gt; {v : STLC.Expr | Annot##lqdc##$select v == x2
                                                 &amp;&amp; Annot##lqdc##$select v == x1
                                                 &amp;&amp; v == Annot x1 x2}</span><span class='hs-conid'>Annot</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == subst x v e}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>subst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | isValue v'
                  &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a>
<span class=hs-linenum>129: </span>
<span class=hs-linenum>130: </span>  <span class='hs-comment'>---   TYPES</span>
<span class=hs-linenum>131: </span>
<span class=hs-linenum>132: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Base</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TInt</span>
<span class=hs-linenum>133: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum>134: </span>
<span class=hs-linenum>135: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TBase</span>   <span class='hs-conid'>Base</span>                 <span class='hs-comment'>-- b</span>
<span class=hs-linenum>136: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TRefn</span>   <span class='hs-conid'>Base</span> <span class='hs-conid'>Vname</span> <span class='hs-conid'>Pred</span>      <span class='hs-comment'>-- b{v : r}</span>
<span class=hs-linenum>137: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TFunc</span>   <span class='hs-conid'>Vname</span> <span class='hs-conid'>Type</span> <span class='hs-conid'>Type</span>      <span class='hs-comment'>-- x:t_x -&gt; t</span>
<span class=hs-linenum>138: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TExists</span> <span class='hs-conid'>Vname</span> <span class='hs-conid'>Type</span> <span class='hs-conid'>Type</span>      <span class='hs-comment'>-- \exists x:t_x.t</span>
<span class=hs-linenum>139: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum>140: </span>
<span class=hs-linenum>141: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>                         <span class='hs-comment'>-- type Env = [(Vname, Type)]	</span>
<span class=hs-linenum>142: </span>         <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Cons</span> <span class='hs-conid'>Vname</span> <span class='hs-conid'>Type</span> <span class='hs-conid'>Env</span>
<span class=hs-linenum>143: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum>144: </span>
<span class=hs-linenum>145: </span><span class='hs-comment'>-- do we really want a separate Bare Type datatype?</span>
<span class=hs-linenum>146: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BTBase</span> <span class='hs-conid'>Base</span>                 <span class='hs-comment'>-- b</span>
<span class=hs-linenum>147: </span>           <span class='hs-keyglyph'>|</span> <span class='hs-conid'>BTFunc</span> <span class='hs-conid'>BType</span> <span class='hs-conid'>BType</span>          <span class='hs-comment'>-- t -&gt; t'</span>
<span class=hs-linenum>148: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum>149: </span>
<span class=hs-linenum>150: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BEmpty</span>                       <span class='hs-comment'>-- type BEnv = [(Vname, BType)]</span>
<span class=hs-linenum>151: </span>          <span class='hs-keyglyph'>|</span> <span class='hs-conid'>BCons</span> <span class='hs-conid'>Vname</span> <span class='hs-conid'>BType</span> <span class='hs-conid'>BEnv</span>
<span class=hs-linenum>152: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>153: </span>
<span class=hs-linenum>154: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>tsize</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>155: </span><span class='hs-definition'>tsize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>156: </span><a class=annot href="#"><span class=annottext>x1:STLC.Type -&gt; {VV : GHC.Types.Int | VV == tsize x1}</span><span class='hs-definition'>tsize</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>TBase</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>	        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Int# | v == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>157: </span><span class='hs-definition'>tsize</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Int# | v == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>158: </span><span class='hs-definition'>tsize</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == tsize t}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tsize</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a>
<span class=hs-linenum>159: </span><span class='hs-definition'>tsize</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExists</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == tsize t}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tsize</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a>
<span class=hs-linenum>160: </span>
<span class=hs-linenum>161: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>erase</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>162: </span><span class='hs-definition'>erase</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span>
<span class=hs-linenum>163: </span><a class=annot href="#"><span class=annottext>x1:STLC.Type -&gt; {VV : STLC.BType | VV == erase x1}</span><span class='hs-definition'>erase</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>TBase</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Base -&gt; {v : STLC.BType | BTBase##lqdc##$select v == x1
                                  &amp;&amp; v == BTBase x1}</span><span class='hs-conid'>BTBase</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum>164: </span><span class='hs-definition'>erase</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Base -&gt; {v : STLC.BType | BTBase##lqdc##$select v == x1
                                  &amp;&amp; v == BTBase x1}</span><span class='hs-conid'>BTBase</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum>165: </span><span class='hs-definition'>erase</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.BType -&gt; x2:STLC.BType -&gt; {v : STLC.BType | BTFunc##lqdc##$select v == x2
                                                    &amp;&amp; BTFunc##lqdc##$select v == x1
                                                    &amp;&amp; v == BTFunc x1 x2}</span><span class='hs-conid'>BTFunc</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.BType | v == erase t_x}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>erase</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t_x}</span><span class='hs-varid'>t_x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.BType | v == erase t}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>erase</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>166: </span><span class='hs-definition'>erase</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExists</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Type -&gt; {VV : STLC.BType | VV == erase x1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>erase</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>167: </span>
<span class=hs-linenum>168: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>free</span> <span class='hs-keyword'>@-}</span> <span class='hs-comment'>-- TODO: verify this</span>
<span class=hs-linenum>169: </span><span class='hs-definition'>free</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>S.Set</span> <span class='hs-conid'>Vname</span>
<span class=hs-linenum>170: </span><a class=annot href="#"><span class=annottext>x1:STLC.Type -&gt; {VV : (Data.Set.Internal.Set [GHC.Types.Char]) | VV == free x1}</span><span class='hs-definition'>free</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>TBase</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
{v : (Data.Set.Internal.Set a) | Set_emp v
                                 &amp;&amp; v == empty}</span><span class='hs-conid'>S.empty</span></a>
<span class=hs-linenum>171: </span><span class='hs-definition'>free</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Classes.Ord [GHC.Types.Char]) | v == $dOrd_a3iT}</span><span class='hs-conid'>S.difference</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == fv r}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fv</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == r}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : (Data.Set.Internal.Set [GHC.Types.Char]) | v' == Set_sng v}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.singleton</span> <a class=annot href="#"><span class=annottext>{v' : [GHC.Types.Char] | len v' &gt;= 0
                         &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>172: </span><span class='hs-definition'>free</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Classes.Ord [GHC.Types.Char]) | v == $dOrd_a3iT}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == free t_x}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>free</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t_x}</span><span class='hs-varid'>t_x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(Data.Set.Internal.Set [GHC.Types.Char])</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.difference</span> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == free t}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>free</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == Set_sng x}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.singleton</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>173: </span><span class='hs-definition'>free</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExists</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Classes.Ord [GHC.Types.Char]) | v == $dOrd_a3iT}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == free t_x}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>free</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t_x}</span><span class='hs-varid'>t_x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(Data.Set.Internal.Set [GHC.Types.Char])</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.difference</span> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == free t}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>free</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Data.Set.Internal.Set [GHC.Types.Char]) | v == Set_sng x}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.singleton</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>174: </span>
<span class=hs-linenum>175: </span><span class='hs-comment'>-- assuming no collisions with bound vars - TODO fix this</span>
<span class=hs-linenum>176: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>tsubst</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>177: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>tsubst</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ v:</span><span class='hs-conid'>Expr</span> <span class='hs-keyword'>| isValue v }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span>  
<span class=hs-linenum>178: </span>                    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ t':</span><span class='hs-conid'>Type</span> <span class='hs-keyword'>| tsize t' &lt;= tsize t &amp;&amp; tsize t' &gt;= 0 }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>179: </span><span class='hs-definition'>tsubst</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span>
<span class=hs-linenum>180: </span><a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; {v : STLC.Expr | isValue v} -&gt; x3:STLC.Type -&gt; {t' : STLC.Type | tsize t' &lt;= tsize x3
                                                                                     &amp;&amp; tsize t' &gt;= 0}</span><span class='hs-definition'>tsubst</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>x</span></a> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>TBase</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Base -&gt; {v : STLC.Type | TBase##lqdc##$select v == x1
                                 &amp;&amp; tsize v == 0
                                 &amp;&amp; v == TBase x1}</span><span class='hs-conid'>TBase</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum>181: </span><span class='hs-definition'>tsubst</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Base -&gt; x2:[GHC.Types.Char] -&gt; x3:STLC.Pred -&gt; {v : STLC.Type | TRefn##lqdc##$select v == x3
                                                                        &amp;&amp; TRefn##lqdc##$select v == x2
                                                                        &amp;&amp; TRefn##lqdc##$select v == x1
                                                                        &amp;&amp; tsize v == 0
                                                                        &amp;&amp; v == TRefn x1 x2 x3}</span><span class='hs-conid'>TRefn</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{v' : [GHC.Types.Char] | len v' &gt;= 0
                         &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>STLC.Pred</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | Ic##lqdc##$select v == n
                 &amp;&amp; v == Ic n}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Ic</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n}</span><span class='hs-varid'>n</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == r}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>182: </span><span class='hs-definition'>tsubst</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Base -&gt; x2:[GHC.Types.Char] -&gt; x3:STLC.Pred -&gt; {v : STLC.Type | TRefn##lqdc##$select v == x3
                                                                        &amp;&amp; TRefn##lqdc##$select v == x2
                                                                        &amp;&amp; TRefn##lqdc##$select v == x1
                                                                        &amp;&amp; tsize v == 0
                                                                        &amp;&amp; v == TRefn x1 x2 x3}</span><span class='hs-conid'>TRefn</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{v' : [GHC.Types.Char] | len v' &gt;= 0
                         &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>STLC.Pred</span><span class='hs-layout'>(</span></a><span class='hs-varid'>bsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Term | Iv##lqdc##$select v == y
                 &amp;&amp; v == Iv y}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Iv</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == y}</span><span class='hs-varid'>y</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == r}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>183: </span><span class='hs-definition'>tsubst</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>_</span>     <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Base -&gt; x2:[GHC.Types.Char] -&gt; x3:STLC.Pred -&gt; {v : STLC.Type | TRefn##lqdc##$select v == x3
                                                                        &amp;&amp; TRefn##lqdc##$select v == x2
                                                                        &amp;&amp; TRefn##lqdc##$select v == x1
                                                                        &amp;&amp; tsize v == 0
                                                                        &amp;&amp; v == TRefn x1 x2 x3}</span><span class='hs-conid'>TRefn</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{v' : [GHC.Types.Char] | len v' &gt;= 0
                         &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == r}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>184: </span><span class='hs-definition'>tsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>z</span> <span class='hs-varid'>t_z</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; x2:STLC.Type -&gt; x3:STLC.Type -&gt; {v : STLC.Type | TFunc##lqdc##$select v == x3
                                                                        &amp;&amp; TFunc##lqdc##$select v == x2
                                                                        &amp;&amp; TFunc##lqdc##$select v == x1
                                                                        &amp;&amp; tsize v == tsize x3 + 1
                                                                        &amp;&amp; v == TFunc x1 x2 x3}</span><span class='hs-conid'>TFunc</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == z}</span><span class='hs-varid'>z</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | tsize v &lt;= tsize t_z
                 &amp;&amp; tsize v &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | isValue v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t_z}</span><span class='hs-varid'>t_z</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | tsize v &lt;= tsize t
                 &amp;&amp; tsize v &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | isValue v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>185: </span><span class='hs-definition'>tsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExists</span> <span class='hs-varid'>z</span> <span class='hs-varid'>t_z</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; x2:STLC.Type -&gt; x3:STLC.Type -&gt; {v : STLC.Type | TExists##lqdc##$select v == x3
                                                                        &amp;&amp; TExists##lqdc##$select v == x2
                                                                        &amp;&amp; TExists##lqdc##$select v == x1
                                                                        &amp;&amp; tsize v == tsize x3 + 1
                                                                        &amp;&amp; v == TExists x1 x2 x3}</span><span class='hs-conid'>TExists</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == z}</span><span class='hs-varid'>z</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | tsize v &lt;= tsize t_z
                 &amp;&amp; tsize v &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | isValue v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t_z}</span><span class='hs-varid'>t_z</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | tsize v &lt;= tsize t
                 &amp;&amp; tsize v &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | isValue v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>186: </span>
<span class=hs-linenum>187: </span><span class='hs-comment'>----- OPERATIONAL SEMANTICS (Small Step)</span>
<span class=hs-linenum>188: </span><span class='hs-comment'>-- E-App1 e e1 -&gt; e' e1 if e-&gt;e'</span>
<span class=hs-linenum>189: </span><span class='hs-comment'>-- E-App2 v e  -&gt; v e'  if e-&gt;e'</span>
<span class=hs-linenum>190: </span><span class='hs-comment'>-- E-AppAbs (\x. e) v -&gt; e[v/x]</span>
<span class=hs-linenum>191: </span><span class='hs-comment'>-- E-Let  let x=e_x in e -&gt; let x=e'_x in e if e_x-&gt;e'_x</span>
<span class=hs-linenum>192: </span><span class='hs-comment'>-- E-LetV let x=v in e -&gt; e[v/x]</span>
<span class=hs-linenum>193: </span><span class='hs-comment'>-- E-Ann   e:t -&gt; e':t  if e-&gt;e'</span>
<span class=hs-linenum>194: </span><span class='hs-comment'>-- E-AnnV  v:t -&gt; v</span>
<span class=hs-linenum>195: </span><span class='hs-comment'>--       Do I want to use contexts instead? E-Ctx ?? does this replace App1/Let1</span>
<span class=hs-linenum>196: </span>
<span class=hs-linenum>197: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>StepP</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>198: </span>    <span class='hs-conid'>Step</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StepP</span>
<span class=hs-linenum>199: </span>
<span class=hs-linenum>200: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Step</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>201: </span>    <span class='hs-conid'>EApp1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span>
<span class=hs-linenum>202: </span>    <span class='hs-conid'>EApp2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span>
<span class=hs-linenum>203: </span>    <span class='hs-conid'>EAppAbs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span>
<span class=hs-linenum>204: </span>    <span class='hs-conid'>ELet</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span>
<span class=hs-linenum>205: </span>    <span class='hs-conid'>ELetV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span>
<span class=hs-linenum>206: </span>    <span class='hs-conid'>EAnn</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span>
<span class=hs-linenum>207: </span>    <span class='hs-conid'>EAnnV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span>
<span class=hs-linenum>208: </span>
<span class=hs-linenum>209: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Step</span> <span class='hs-keyword'>where</span> 
<span class=hs-linenum>210: </span>    <span class='hs-conid'>EApp1</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span> <span class='hs-layout'>)</span> 
<span class=hs-linenum>211: </span>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e1</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>e1</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>212: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>EApp2</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>213: </span>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>{</span> <span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isValue</span> <span class='hs-varid'>v</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>v</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>v</span> <span class='hs-varid'>e'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>214: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>EAppAbs</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>{</span> <span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isValue</span> <span class='hs-varid'>v</span> <span class='hs-layout'>}</span> 
<span class=hs-linenum>215: </span>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lambda</span> <span class='hs-varid'>x</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>subst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>216: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>ELet</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e_x'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-varid'>e_x</span> <span class='hs-varid'>e_x'</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>217: </span>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-layout'>(</span><span class='hs-conid'>Let</span> <span class='hs-varid'>x</span> <span class='hs-varid'>e_x</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Let</span> <span class='hs-varid'>x</span> <span class='hs-varid'>e_x'</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>218: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>ELetV</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>{</span> <span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isValue</span> <span class='hs-varid'>v</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span>
<span class=hs-linenum>219: </span>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-layout'>(</span><span class='hs-conid'>Let</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>subst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>220: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>EAnn</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>221: </span>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Step</span> <span class='hs-layout'>(</span><span class='hs-conid'>Annot</span> <span class='hs-varid'>e</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Annot</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>222: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>EAnnV</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>{</span> <span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isValue</span> <span class='hs-varid'>v</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-layout'>(</span><span class='hs-conid'>Annot</span> <span class='hs-varid'>v</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>223: </span>
<span class=hs-linenum>224: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>EvalsToP</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>225: </span>    <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsToP</span>
<span class=hs-linenum>226: </span>
<span class=hs-linenum>227: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>228: </span>    <span class='hs-conid'>Refl</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span>
<span class=hs-linenum>229: </span>    <span class='hs-conid'>AddStep</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Step</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span>
<span class=hs-linenum>230: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyword'>where</span> 
<span class=hs-linenum>231: </span>    <span class='hs-conid'>Refl</span>     <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span> <span class='hs-layout'>(</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>232: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>AddStep</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e1</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e2</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>Step</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span> <span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e3</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span>
<span class=hs-linenum>233: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span> <span class='hs-layout'>(</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e2</span> <span class='hs-varid'>e3</span> <span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e3</span> <span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span> <span class='hs-comment'>-- @-} </span>
<span class=hs-linenum>234: </span>  
<span class=hs-linenum>235: </span><span class='hs-comment'>-- EvalsToP is the transitive/reflexive closure of StepP:</span>
<span class=hs-linenum>236: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>lemma_evals_trans</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e1</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e2</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e3</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>237: </span>                    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e2</span> <span class='hs-varid'>e3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e3</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span> 
<span class=hs-linenum>238: </span><span class='hs-definition'>lemma_evals_trans</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span>
<span class=hs-linenum>239: </span><a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; x3:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x2 x3} -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x3}</span><span class='hs-definition'>lemma_evals_trans</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>e1</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>e2</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>e3</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Refl</span> <span class='hs-sel'>_e1</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e2 e3}</span><span class='hs-varid'>p_e2e3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e2 e3
                    &amp;&amp; v == p_e2e3}</span><span class='hs-varid'>p_e2e3</span></a>
<span class=hs-linenum>240: </span><span class='hs-definition'>lemma_evals_trans</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span> <span class='hs-varid'>e3</span> <span class='hs-layout'>(</span><span class='hs-conid'>AddStep</span> <span class='hs-sel'>_e1</span> <span class='hs-varid'>e</span> <span class='hs-varid'>p_e1e</span> <span class='hs-sel'>_e2</span> <span class='hs-varid'>p_ee2</span><span class='hs-layout'>)</span> <span class='hs-varid'>p_e2e3</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | AddStep##lqdc##$select v == p_ee3
                    &amp;&amp; AddStep v == e3
                    &amp;&amp; AddStep##lqdc##$select v == p_e1e
                    &amp;&amp; AddStep v == e
                    &amp;&amp; AddStep v == e1
                    &amp;&amp; prop v == EvalsTo e1 e3
                    &amp;&amp; v == AddStep e1 e p_e1e e3 p_ee3
                    &amp;&amp; v == p_e1e3}</span><span class='hs-varid'>p_e1e3</span></a>
<span class=hs-linenum>241: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>242: </span>    <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | AddStep##lqdc##$select v == p_ee3
                    &amp;&amp; AddStep v == e3
                    &amp;&amp; AddStep##lqdc##$select v == p_e1e
                    &amp;&amp; AddStep v == e
                    &amp;&amp; AddStep v == e1
                    &amp;&amp; prop v == EvalsTo e1 e3
                    &amp;&amp; v == AddStep e1 e p_e1e e3 p_ee3}</span><span class='hs-varid'>p_e1e3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | AddStep##lqdc##$select v == p_ee3
                    &amp;&amp; AddStep v == e3
                    &amp;&amp; AddStep##lqdc##$select v == p_e1e
                    &amp;&amp; AddStep v == e
                    &amp;&amp; AddStep v == e1
                    &amp;&amp; prop v == EvalsTo e1 e3
                    &amp;&amp; v == AddStep e1 e p_e1e e3 p_ee3}</span><span class='hs-conid'>AddStep</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e1}</span><span class='hs-varid'>e1</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Step | prop v == Step _e1 e
                 &amp;&amp; v == p_e1e}</span><span class='hs-varid'>p_e1e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e3}</span><span class='hs-varid'>e3</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e3
                    &amp;&amp; v == p_ee3}</span><span class='hs-varid'>p_ee3</span></a>
<span class=hs-linenum>243: </span>    <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e3}</span><span class='hs-varid'>p_ee3</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; x3:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x2 x3} -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x3}</span><span class='hs-varid'>lemma_evals_trans</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e2}</span><span class='hs-varid'>e2</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e3}</span><span class='hs-varid'>e3</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e _e2
                    &amp;&amp; v == p_ee2}</span><span class='hs-varid'>p_ee2</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e2 e3
                    &amp;&amp; v == p_e2e3}</span><span class='hs-varid'>p_e2e3</span></a>
<span class=hs-linenum>244: </span>
<span class=hs-linenum>245: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>lemma_app_many</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>246: </span>                       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>EvalsTo</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>e</span> <span class='hs-varid'>v'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>v'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>247: </span><span class='hs-definition'>lemma_app_many</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span>
<span class=hs-linenum>248: </span><a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; x3:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; {v : STLC.EvalsTo | prop v == EvalsTo (App x1 x3) (App x2 x3)}</span><span class='hs-definition'>lemma_app_many</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>v</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Refl</span> <span class='hs-sel'>_e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; {v : STLC.EvalsTo | Refl v == x1
                                    &amp;&amp; prop v == EvalsTo x1 x1
                                    &amp;&amp; v == Refl x1}</span><span class='hs-conid'>Refl</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | App##lqdc##$select v' == v
                  &amp;&amp; App##lqdc##$select v' == e
                  &amp;&amp; v' == App e v}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>App</span> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>249: </span><span class='hs-definition'>lemma_app_many</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>AddStep</span> <span class='hs-sel'>_e</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>s_ee1</span> <span class='hs-sel'>_e'</span> <span class='hs-varid'>p_e1e'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | AddStep##lqdc##$select v == p_e1v_e'v
                    &amp;&amp; AddStep##lqdc##$select v == s_ev_e1v
                    &amp;&amp; v == p_ev_e'v}</span><span class='hs-varid'>p_ev_e'v</span></a>
<span class=hs-linenum>250: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>251: </span>    <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | AddStep##lqdc##$select v == p_e1v_e'v
                    &amp;&amp; AddStep##lqdc##$select v == s_ev_e1v}</span><span class='hs-varid'>p_ev_e'v</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | AddStep##lqdc##$select v == p_e1v_e'v
                    &amp;&amp; AddStep##lqdc##$select v == s_ev_e1v}</span><span class='hs-conid'>AddStep</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | App##lqdc##$select v' == v
                  &amp;&amp; App##lqdc##$select v' == e
                  &amp;&amp; v' == App e v}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>App</span> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | App##lqdc##$select v' == v
                  &amp;&amp; App##lqdc##$select v' == e1
                  &amp;&amp; v' == App e1 v}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>App</span> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e1}</span><span class='hs-varid'>e1</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Step | EApp1 v' == v
                  &amp;&amp; EApp1##lqdc##$select v' == s_ee1
                  &amp;&amp; EApp1 v' == e1
                  &amp;&amp; EApp1 v' == e
                  &amp;&amp; prop v' == Step (App e v) (App e1 v)
                  &amp;&amp; v' == EApp1 e e1 s_ee1 v
                  &amp;&amp; v' == s_ev_e1v}</span><span class='hs-varid'>s_ev_e1v</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | App##lqdc##$select v' == v
                  &amp;&amp; App##lqdc##$select v' == e'
                  &amp;&amp; v' == App e' v}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>App</span> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : STLC.EvalsTo | prop v' == EvalsTo (App e1 v) (App e' v)
                     &amp;&amp; v' == p_e1v_e'v}</span><span class='hs-varid'>p_e1v_e'v</span></a>
<span class=hs-linenum>252: </span>    <a class=annot href="#"><span class=annottext>{v' : STLC.Step | EApp1 v' == v
                  &amp;&amp; EApp1##lqdc##$select v' == s_ee1
                  &amp;&amp; EApp1 v' == e1
                  &amp;&amp; EApp1 v' == e
                  &amp;&amp; prop v' == Step (App e v) (App e1 v)
                  &amp;&amp; v' == EApp1 e e1 s_ee1 v}</span><span class='hs-varid'>s_ev_e1v</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Step | EApp1 v' == v
                  &amp;&amp; EApp1##lqdc##$select v' == s_ee1
                  &amp;&amp; EApp1 v' == e1
                  &amp;&amp; EApp1 v' == e
                  &amp;&amp; prop v' == Step (App e v) (App e1 v)
                  &amp;&amp; v' == EApp1 e e1 s_ee1 v}</span><span class='hs-conid'>EApp1</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e1}</span><span class='hs-varid'>e1</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Step | prop v == Step _e e1
                 &amp;&amp; v == s_ee1}</span><span class='hs-varid'>s_ee1</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a> 
<span class=hs-linenum>253: </span>    <a class=annot href="#"><span class=annottext>{v' : STLC.EvalsTo | prop v' == EvalsTo (App e1 v) (App e' v)}</span><span class='hs-varid'>p_e1v_e'v</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; x3:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; {v : STLC.EvalsTo | prop v == EvalsTo (App x1 x3) (App x2 x3)}</span><span class='hs-varid'>lemma_app_many</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e1}</span><span class='hs-varid'>e1</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e1 _e'
                    &amp;&amp; v == p_e1e'}</span><span class='hs-varid'>p_e1e'</span></a> 
<span class=hs-linenum>254: </span>
<span class=hs-linenum>255: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>BEvalsToP</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>256: </span>    <span class='hs-conid'>BEvalsTo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BEvalsToP</span>
<span class=hs-linenum>257: </span>
<span class=hs-linenum>258: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>BEvalsTo</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>259: </span>    <span class='hs-conid'>BvalTo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BEvalsTo</span>
<span class=hs-linenum>260: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>BEvalsTo</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>261: </span>    <span class='hs-conid'>BvalTo</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>{</span> <span class='hs-varid'>p</span><span class='hs-conop'>:</span><span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>bval</span> <span class='hs-varid'>p</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>BEvalsTo</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bc</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>262: </span>
<span class=hs-linenum>263: </span><span class='hs-comment'>----- the Bare-Typing Relation and the Typing Relation</span>
<span class=hs-linenum>264: </span>
<span class=hs-linenum>265: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>HasBTypeP</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>266: </span>    <span class='hs-conid'>HasBType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBTypeP</span> 
<span class=hs-linenum>267: </span>
<span class=hs-linenum>268: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>HasBType</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>269: </span>    <span class='hs-conid'>BTVar</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span>
<span class=hs-linenum>270: </span>    <span class='hs-conid'>BTCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span>
<span class=hs-linenum>271: </span>    <span class='hs-conid'>BTAbs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span>
<span class=hs-linenum>272: </span>    <span class='hs-conid'>BTApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span> 
<span class=hs-linenum>273: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span>
<span class=hs-linenum>274: </span>    <span class='hs-conid'>BTLet</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span>
<span class=hs-linenum>275: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span>
<span class=hs-linenum>276: </span>    <span class='hs-conid'>BTAnn</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span>
<span class=hs-linenum>277: </span>
<span class=hs-linenum>278: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>HasBType</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>279: </span>    <span class='hs-conid'>BTVar</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>{</span><span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>BType</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>elem</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>280: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>BTCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>BTBase</span> <span class='hs-conid'>TInt</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>281: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>BTAbs</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b'</span><span class='hs-conop'>:</span><span class='hs-conid'>BType</span>
<span class=hs-linenum>282: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-layout'>(</span><span class='hs-conid'>BCons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>b</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>283: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lambda</span> <span class='hs-varid'>x</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>BTFunc</span> <span class='hs-varid'>b</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>284: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>BTApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b'</span><span class='hs-conop'>:</span><span class='hs-conid'>BType</span>
<span class=hs-linenum>285: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>BTFunc</span> <span class='hs-varid'>b</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>286: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>287: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span><span class='hs-layout'>)</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>288: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>BTLet</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e_x</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>289: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b'</span><span class='hs-conop'>:</span><span class='hs-conid'>BType</span> 
<span class=hs-linenum>290: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-layout'>(</span><span class='hs-conid'>BCons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>b</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>291: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Let</span> <span class='hs-varid'>x</span> <span class='hs-varid'>e_x</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>292: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>BTAnn</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>BEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>293: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Annot</span> <span class='hs-varid'>e</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>            <span class='hs-keyword'>@-}</span> <span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>294: </span>
<span class=hs-linenum>295: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-varid'>lemma_soundness</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>BType</span>
<span class=hs-linenum>296: </span>                   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-conid'>BEmpty</span> <span class='hs-varid'>e</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-conid'>BEmpty</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>297: </span><span class='hs-definition'>lemma_soundness</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span>
<span class=hs-linenum>298: </span><a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; x4:STLC.BType -&gt; {v : STLC.HasBType | prop v == HasBType BEmpty x1 x4} -&gt; {v : STLC.HasBType | prop v == HasBType BEmpty x2 x4}</span><span class='hs-definition'>lemma_soundness</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>STLC.EvalsTo</span><span class='hs-varid'>p_ee'</span></a> <a class=annot href="#"><span class=annottext>STLC.BType</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>STLC.HasBType</span><span class='hs-varid'>p_eb</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<span class=hs-linenum>299: </span>
<span class=hs-linenum>300: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>HasTypeP</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>301: </span>    <span class='hs-conid'>HasType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasTypeP</span> <span class='hs-comment'>-- HasType G e t means G |- e : t</span>
<span class=hs-linenum>302: </span>
<span class=hs-linenum>303: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>HasType</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>304: </span>    <span class='hs-conid'>TVar</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span>
<span class=hs-linenum>305: </span>    <span class='hs-conid'>TCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span>
<span class=hs-linenum>306: </span>    <span class='hs-conid'>TAbs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span>
<span class=hs-linenum>307: </span>    <span class='hs-conid'>TApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span> 
<span class=hs-linenum>308: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span>
<span class=hs-linenum>309: </span>    <span class='hs-conid'>TLet</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span>
<span class=hs-linenum>310: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span>
<span class=hs-linenum>311: </span>    <span class='hs-conid'>TAnn</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span>
<span class=hs-linenum>312: </span>    <span class='hs-conid'>TSub</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Subtype</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span>
<span class=hs-linenum>313: </span>
<span class=hs-linenum>314: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>HasType</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>315: </span>    <span class='hs-conid'>TVar</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>{</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>elem</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<span class=hs-linenum>316: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>TCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>TBase</span> <span class='hs-conid'>TInt</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>317: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>TAbs</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span>
<span class=hs-linenum>318: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<span class=hs-linenum>319: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lambda</span> <span class='hs-varid'>x</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>320: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>TApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span>
<span class=hs-linenum>321: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>322: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>t_x</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>323: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExists</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>324: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>TLet</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e_x</span> <span class='hs-varid'>t_x</span><span class='hs-layout'>)</span>
<span class=hs-linenum>325: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> 
<span class=hs-linenum>326: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<span class=hs-linenum>327: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Let</span> <span class='hs-varid'>x</span> <span class='hs-varid'>e_x</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<span class=hs-linenum>328: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>TAnn</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<span class=hs-linenum>329: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Annot</span> <span class='hs-varid'>e</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<span class=hs-linenum>330: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>TSub</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span>
<span class=hs-linenum>331: </span>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Subtype</span> <span class='hs-varid'>g</span> <span class='hs-varid'>s</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>e</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span> <span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>332: </span>
<span class=hs-linenum>333: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>SubtypeP</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>334: </span>    <span class='hs-conid'>Subtype</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SubtypeP</span>
<span class=hs-linenum>335: </span>
<span class=hs-linenum>336: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Subtype</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>337: </span>    <span class='hs-conid'>SBase</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Base</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Entails</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Subtype</span>
<span class=hs-linenum>338: </span>    <span class='hs-conid'>SFunc</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Subtype</span>
<span class=hs-linenum>339: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Subtype</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Subtype</span>
<span class=hs-linenum>340: </span>    <span class='hs-comment'>-- TODO: Is this the form of [S-WITN] that we need?</span>
<span class=hs-linenum>341: </span>    <span class='hs-conid'>SWitn</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span>
<span class=hs-linenum>342: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Subtype</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Subtype</span>
<span class=hs-linenum>343: </span>    <span class='hs-conid'>SBind</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Subtype</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Subtype</span>
<span class=hs-linenum>344: </span>
<span class=hs-linenum>345: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Subtype</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>346: </span>    <span class='hs-conid'>SBase</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>Base</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>p1</span><span class='hs-conop'>:</span><span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v2</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>p2</span><span class='hs-conop'>:</span><span class='hs-conid'>Pred</span>
<span class=hs-linenum>347: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Entails</span> <span class='hs-layout'>(</span> <span class='hs-conid'>Cons</span> <span class='hs-varid'>v1</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>p1</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>bsubst</span> <span class='hs-varid'>v2</span> <span class='hs-layout'>(</span><span class='hs-conid'>Iv</span> <span class='hs-varid'>v1</span><span class='hs-layout'>)</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>348: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Subtype</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>p1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>349: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>SFunc</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x1</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s1</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x2</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s2</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span>
<span class=hs-linenum>350: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Subtype</span> <span class='hs-varid'>g</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>s1</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t1</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t2</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span>
<span class=hs-linenum>351: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Subtype</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cons</span> <span class='hs-varid'>x2</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>tsubst</span> <span class='hs-varid'>x1</span> <span class='hs-varid'>x2</span> <span class='hs-varid'>t1</span><span class='hs-layout'>)</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>352: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Subtype</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>x1</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>t1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>x2</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>353: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>SWitn</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>y</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>y</span> <span class='hs-varid'>t_x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> 
<span class=hs-linenum>354: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t'</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Subtype</span> <span class='hs-varid'>g</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-varid'>tsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>t'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>355: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Subtype</span> <span class='hs-varid'>g</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExists</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>356: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>SBind</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasType</span> <span class='hs-varid'>g</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span>
<span class=hs-linenum>357: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>{</span> <span class='hs-varid'>t'</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>not</span> <span class='hs-conid'>S.elem</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-varid'>free</span> <span class='hs-varid'>t'</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span> 
<span class=hs-linenum>358: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Subtype</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span> <span class='hs-varid'>t'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>359: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Subtype</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExists</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>t'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>360: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>361: </span>
<span class=hs-linenum>362: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>SMTValidP</span> <span class='hs-keyword'>where</span> <span class='hs-comment'>--dummy SMT Validity certificates</span>
<span class=hs-linenum>363: </span>    <span class='hs-conid'>SMTValid</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Form</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SMTValidP</span>
<span class=hs-linenum>364: </span>
<span class=hs-linenum>365: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>SMTValid</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>366: </span>    <span class='hs-conid'>SMTProp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SMTValid</span>
<span class=hs-linenum>367: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>SMTValid</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>368: </span>    <span class='hs-conid'>SMTProp</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>{</span> <span class='hs-varid'>p</span><span class='hs-conop'>:</span><span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>fv</span> <span class='hs-varid'>p</span> <span class='hs-varop'>==</span> <span class='hs-conid'>S.empty</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>bval</span> <span class='hs-varid'>p</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>SMTValid</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>369: </span>
<span class=hs-linenum>370: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>EntailsP</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>371: </span>    <span class='hs-conid'>Entails</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Form</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EntailsP</span>
<span class=hs-linenum>372: </span>
<span class=hs-linenum>373: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Entails</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>374: </span>    <span class='hs-conid'>EntEmp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Form</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SMTValid</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Entails</span>
<span class=hs-linenum>375: </span>    <span class='hs-conid'>EntExt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Base</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Form</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Entails</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Entails</span>
<span class=hs-linenum>376: </span>
<span class=hs-linenum>377: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Entails</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>378: </span>    <span class='hs-conid'>EntEmp</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-conid'>Form</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>SMTValid</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Entails</span> <span class='hs-conid'>BEmpty</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum>379: </span> <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>EntExt</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span><span class='hs-conop'>:</span><span class='hs-conid'>Env</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>Base</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>p</span><span class='hs-conop'>:</span><span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-conid'>Form</span>
<span class=hs-linenum>380: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Entails</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Impl</span> <span class='hs-varid'>v</span> <span class='hs-varid'>b</span> <span class='hs-varid'>p</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>381: </span>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Entails</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cons</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>v</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>  <span class='hs-keyword'>@-}</span> <span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>382: </span>
<span class=hs-linenum>383: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>DenotesP</span> <span class='hs-keyword'>where</span> 
<span class=hs-linenum>384: </span>    <span class='hs-conid'>Denotes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DenotesP</span>    <span class='hs-comment'>-- e \in [[t]]</span>
<span class=hs-linenum>385: </span>
<span class=hs-linenum>386: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Denotes</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>387: </span>    <span class='hs-conid'>DBase</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Base</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span>
<span class=hs-linenum>388: </span>    <span class='hs-conid'>DRefn</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Base</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span> 
<span class=hs-linenum>389: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BEvalsTo</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span>
<span class=hs-linenum>390: </span>    <span class='hs-conid'>DFunc</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span>
<span class=hs-linenum>391: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span>
<span class=hs-linenum>392: </span>    <span class='hs-conid'>DExis</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HasBType</span>
<span class=hs-linenum>393: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span>
<span class=hs-linenum>394: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Denotes</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>395: </span>    <span class='hs-conid'>DBase</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>Base</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-conid'>BEmpty</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>BTBase</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>396: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-layout'>(</span><span class='hs-conid'>TBase</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<span class=hs-linenum>397: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DRefn</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>Base</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>p</span><span class='hs-conop'>:</span><span class='hs-conid'>Pred</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> 
<span class=hs-linenum>398: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-conid'>BEmpty</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>BTBase</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>399: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>v'</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>v'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>400: </span>                        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>BEvalsTo</span> <span class='hs-layout'>(</span><span class='hs-varid'>bsubst</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ic</span> <span class='hs-varid'>v'</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bc</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>401: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<span class=hs-linenum>402: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DFunc</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> 
<span class=hs-linenum>403: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-conid'>BEmpty</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-varid'>erase</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>404: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-layout'>{</span> <span class='hs-varid'>v'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isValue</span> <span class='hs-varid'>v'</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>v'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>405: </span>                        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>tsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v'</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>App</span> <span class='hs-varid'>e</span> <span class='hs-varid'>v'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>)</span>
<span class=hs-linenum>406: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<span class=hs-linenum>407: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DExis</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vname</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t_x</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> 
<span class=hs-linenum>408: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>HasBType</span> <span class='hs-conid'>BEmpty</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-varid'>erase</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>409: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>{</span> <span class='hs-varid'>v'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isValue</span> <span class='hs-varid'>v'</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>v'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>410: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>tsubst</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v'</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<span class=hs-linenum>411: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExists</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>  <span class='hs-keyword'>@-}</span> 
<span class=hs-linenum>412: </span>
<span class=hs-linenum>413: </span><span class='hs-comment'>-- old version of DRefn, in case I want to bring back BEvalsTo</span>
<span class=hs-linenum>414: </span><span class='hs-comment'>-- | DRefn :: b:Base -&gt; x:Vname -&gt; p:Pred -&gt; e:Expr -&gt; ProofOf(HasBType [] e b)</span>
<span class=hs-linenum>415: </span><span class='hs-comment'>--              -&gt; (v:Int -&gt; ProofOf(EvalsTo e (C v)) </span>
<span class=hs-linenum>416: </span><span class='hs-comment'>--                        -&gt; ProofOf(BEvalsTo (bsubst x (Ic v) p) (Bc True)) )</span>
<span class=hs-linenum>417: </span><span class='hs-comment'>--              -&gt; ProofOf(Denotes (TRefn b x p) e)</span>
<span class=hs-linenum>418: </span>
<span class=hs-linenum>419: </span><span class='hs-comment'>-- TODO: Still need closing substitutions</span>
<span class=hs-linenum>420: </span><span class='hs-comment'>-- TODO: Still need denotations of environments</span>
<span class=hs-linenum>421: </span>
<span class=hs-linenum>422: </span><span class='hs-comment'>-- Lemma 1 in the Pen and Paper version (Preservation of Denotations)</span>
<span class=hs-linenum>423: </span><span class='hs-comment'>-- If e -&gt;* e' then e in [[t]] iff e' in [[t]]</span>
<span class=hs-linenum>424: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>lemma1_fwd</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span>
<span class=hs-linenum>425: </span>                   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-varid'>t</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-varid'>t</span> <span class='hs-varid'>e'</span><span class='hs-layout'>)</span> <span class='hs-varop'>/</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>tsize</span> <span class='hs-varid'>t</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>426: </span><span class='hs-definition'>lemma1_fwd</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span>
<span class=hs-linenum>427: </span><a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; x4:STLC.Type -&gt; {v : STLC.Denotes | prop v == Denotes x4 x1} -&gt; {v : STLC.Denotes | prop v == Denotes x4 x2}</span><span class='hs-definition'>lemma1_fwd</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e'}</span><span class='hs-varid'>p_ee'</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>TBase</span> <span class='hs-sel'>_b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>DBase</span> <span class='hs-varid'>b</span> <span class='hs-sel'>_e</span> <span class='hs-varid'>p_eb</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Base -&gt; x2:STLC.Expr -&gt; x3:{v : STLC.HasBType | prop v == HasBType BEmpty x2 (BTBase x1)} -&gt; {v : STLC.Denotes | DBase##lqdc##$select v == x3
                                                                                                                         &amp;&amp; DBase v == x2
                                                                                                                         &amp;&amp; DBase v == x1
                                                                                                                         &amp;&amp; prop v == Denotes (TBase x1) x2
                                                                                                                         &amp;&amp; v == DBase x1 x2 x3}</span><span class='hs-conid'>DBase</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.HasBType | v == p_e'b}</span><span class='hs-varid'>p_e'b</span></a>
<span class=hs-linenum>428: </span>  <span class='hs-keyword'>where</span> 
<span class=hs-linenum>429: </span>    <a class=annot href="#"><span class=annottext>STLC.HasBType</span><span class='hs-varid'>p_e'b</span></a>              <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>STLC.HasBType</span><span class='hs-varid'>lemma_soundness</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e'
                    &amp;&amp; v == p_ee'}</span><span class='hs-varid'>p_ee'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.BType | BTBase##lqdc##$select v == b
                  &amp;&amp; v == BTBase b}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>BTBase</span> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.HasBType | prop v == HasBType BEmpty _e (BTBase b)
                     &amp;&amp; v == p_eb}</span><span class='hs-varid'>p_eb</span></a>
<span class=hs-linenum>430: </span><span class='hs-definition'>lemma1_fwd</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>p_ee'</span> <span class='hs-layout'>(</span><span class='hs-conid'>TRefn</span> <span class='hs-sel'>_b</span> <span class='hs-sel'>_x</span> <span class='hs-sel'>_p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>DRefn</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span> <span class='hs-varid'>p</span> <span class='hs-sel'>_e</span> <span class='hs-varid'>p_eb</span> <span class='hs-varid'>predicate</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : STLC.Denotes | DRefn##lqdc##$select v == predicate2
                    &amp;&amp; DRefn##lqdc##$select v == p_e'b
                    &amp;&amp; DRefn v == e'
                    &amp;&amp; DRefn v == p
                    &amp;&amp; DRefn v == x
                    &amp;&amp; DRefn v == b
                    &amp;&amp; prop v == Denotes (TRefn b x p) e'
                    &amp;&amp; v == DRefn b x p e' p_e'b predicate2
                    &amp;&amp; v == den_te'}</span><span class='hs-varid'>den_te'</span></a>
<span class=hs-linenum>431: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>432: </span>    <a class=annot href="#"><span class=annottext>{v : STLC.Denotes | DRefn##lqdc##$select v == predicate2
                    &amp;&amp; DRefn##lqdc##$select v == p_e'b
                    &amp;&amp; DRefn v == e'
                    &amp;&amp; DRefn v == p
                    &amp;&amp; DRefn v == x
                    &amp;&amp; DRefn v == b
                    &amp;&amp; prop v == Denotes (TRefn b x p) e'
                    &amp;&amp; v == DRefn b x p e' p_e'b predicate2}</span><span class='hs-varid'>den_te'</span></a>            <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : STLC.Denotes | DRefn##lqdc##$select v == predicate2
                    &amp;&amp; DRefn##lqdc##$select v == p_e'b
                    &amp;&amp; DRefn v == e'
                    &amp;&amp; DRefn v == p
                    &amp;&amp; DRefn v == x
                    &amp;&amp; DRefn v == b
                    &amp;&amp; prop v == Denotes (TRefn b x p) e'
                    &amp;&amp; v == DRefn b x p e' p_e'b predicate2}</span><span class='hs-conid'>DRefn</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Pred | v == p}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.HasBType | v == p_e'b}</span><span class='hs-varid'>p_e'b</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; {v : STLC.EvalsTo | prop v == EvalsTo e' (C x1)} -&gt; {v : STLC.BEvalsTo | prop v == BEvalsTo (bsubst x (Ic x1) p) (Bc true)}</span><span class='hs-varid'>predicate2</span></a>
<span class=hs-linenum>433: </span>    <a class=annot href="#"><span class=annottext>STLC.HasBType</span><span class='hs-varid'>p_e'b</span></a>              <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>STLC.HasBType</span><span class='hs-varid'>lemma_soundness</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e'
                    &amp;&amp; v == p_ee'}</span><span class='hs-varid'>p_ee'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.BType | BTBase##lqdc##$select v == b
                  &amp;&amp; v == BTBase b}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>BTBase</span> <a class=annot href="#"><span class=annottext>{v : STLC.Base | v == b}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.HasBType | prop v == HasBType BEmpty _e (BTBase b)
                     &amp;&amp; v == p_eb}</span><span class='hs-varid'>p_eb</span></a>
<span class=hs-linenum>434: </span>    <span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate2</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>w</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e'</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>435: </span>                            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span> <span class='hs-conid'>BEvalsTo</span> <span class='hs-layout'>(</span><span class='hs-varid'>bsubst</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ic</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bc</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>436: </span>    <span class='hs-varid'>predicate2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BEvalsTo</span>
<span class=hs-linenum>437: </span>    <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; {v : STLC.EvalsTo | prop v == EvalsTo e' (C x1)} -&gt; {v : STLC.BEvalsTo | prop v == BEvalsTo (bsubst x (Ic x1) p) (Bc true)}</span><span class='hs-varid'>predicate2</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e' (C v)}</span><span class='hs-varid'>p_e'v</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; {v : STLC.EvalsTo | prop v == EvalsTo _e (C x1)} -&gt; {v : STLC.BEvalsTo | prop v == BEvalsTo (bsubst x (Ic x1) p) (Bc True)}</span><span class='hs-varid'>predicate</span></a> <a class=annot href="#"><span class=annottext>{v' : GHC.Types.Int | v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>STLC.EvalsTo</span><span class='hs-layout'>(</span></a><span class='hs-varid'>lemma_evals_trans</span> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | C##lqdc##$select v' == v
                  &amp;&amp; v' == C v}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>{v' : GHC.Types.Int | v' == v}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e'
                    &amp;&amp; v == p_ee'}</span><span class='hs-varid'>p_ee'</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.EvalsTo | prop v' == EvalsTo e' (C v)
                     &amp;&amp; v' == p_e'v}</span><span class='hs-varid'>p_e'v</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>438: </span><span class='hs-definition'>lemma1_fwd</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>p_ee'</span> <span class='hs-layout'>(</span><span class='hs-conid'>TFunc</span> <span class='hs-sel'>_x</span> <span class='hs-sel'>_tx</span> <span class='hs-sel'>_t</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>DFunc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span> <span class='hs-sel'>_e</span> <span class='hs-varid'>p_ebt</span> <span class='hs-varid'>app_den</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : STLC.Denotes | DFunc##lqdc##$select v == app_den'
                    &amp;&amp; DFunc##lqdc##$select v == p_e'bt
                    &amp;&amp; DFunc v == e'
                    &amp;&amp; DFunc v == t
                    &amp;&amp; DFunc v == t_x
                    &amp;&amp; DFunc v == x
                    &amp;&amp; prop v == Denotes (TFunc x t_x t) e'
                    &amp;&amp; v == DFunc x t_x t e' p_e'bt app_den'
                    &amp;&amp; v == den_te'}</span><span class='hs-varid'>den_te'</span></a>
<span class=hs-linenum>439: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>440: </span>    <a class=annot href="#"><span class=annottext>{v : STLC.Denotes | DFunc##lqdc##$select v == app_den'
                    &amp;&amp; DFunc##lqdc##$select v == p_e'bt
                    &amp;&amp; DFunc v == e'
                    &amp;&amp; DFunc v == t
                    &amp;&amp; DFunc v == t_x
                    &amp;&amp; DFunc v == x
                    &amp;&amp; prop v == Denotes (TFunc x t_x t) e'
                    &amp;&amp; v == DFunc x t_x t e' p_e'bt app_den'}</span><span class='hs-varid'>den_te'</span></a>          <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : STLC.Denotes | DFunc##lqdc##$select v == app_den'
                    &amp;&amp; DFunc##lqdc##$select v == p_e'bt
                    &amp;&amp; DFunc v == e'
                    &amp;&amp; DFunc v == t
                    &amp;&amp; DFunc v == t_x
                    &amp;&amp; DFunc v == x
                    &amp;&amp; prop v == Denotes (TFunc x t_x t) e'
                    &amp;&amp; v == DFunc x t_x t e' p_e'bt app_den'}</span><span class='hs-conid'>DFunc</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t_x}</span><span class='hs-varid'>t_x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.HasBType | v == p_e'bt}</span><span class='hs-varid'>p_e'bt</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr -&gt; STLC.Denotes -&gt; STLC.Denotes</span><span class='hs-varid'>app_den'</span></a>
<span class=hs-linenum>441: </span>    <a class=annot href="#"><span class=annottext>STLC.HasBType</span><span class='hs-varid'>p_e'bt</span></a>           <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>STLC.HasBType</span><span class='hs-varid'>lemma_soundness</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e'
                    &amp;&amp; v == p_ee'}</span><span class='hs-varid'>p_ee'</span></a> <a class=annot href="#"><span class=annottext>STLC.BType</span><span class='hs-layout'>(</span></a><span class='hs-varid'>erase</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | TFunc##lqdc##$select v == t
                 &amp;&amp; TFunc##lqdc##$select v == t_x
                 &amp;&amp; TFunc##lqdc##$select v == x
                 &amp;&amp; tsize v == tsize t + 1
                 &amp;&amp; v == TFunc x t_x t}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>TFunc</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t_x}</span><span class='hs-varid'>t_x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.HasBType | prop v == HasBType BEmpty _e (erase (TFunc x t_x t))
                     &amp;&amp; v == p_ebt}</span><span class='hs-varid'>p_ebt</span></a>
<span class=hs-linenum>442: </span>    <a class=annot href="#"><span class=annottext>STLC.Expr -&gt; STLC.Denotes -&gt; STLC.Denotes</span><span class='hs-varid'>app_den'</span></a> <a class=annot href="#"><span class=annottext>STLC.Expr</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>STLC.Denotes</span><span class='hs-varid'>d_txv</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; x4:STLC.Type -&gt; {v : STLC.Denotes | prop v == Denotes x4 x1} -&gt; {v : STLC.Denotes | prop v == Denotes x4 x2}</span><span class='hs-varid'>lemma1_fwd</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | App##lqdc##$select v' == v
                  &amp;&amp; App##lqdc##$select v' == e
                  &amp;&amp; v' == App e v}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>App</span> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | App##lqdc##$select v' == v
                  &amp;&amp; App##lqdc##$select v' == e'
                  &amp;&amp; v' == App e' v}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>App</span> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : STLC.EvalsTo | prop v' == EvalsTo (App e v) (App e' v)
                     &amp;&amp; v' == p_ev_e'v}</span><span class='hs-varid'>p_ev_e'v</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Type | tsize v' &lt;= tsize t
                  &amp;&amp; tsize v' &gt;= 0
                  &amp;&amp; v' == tsubst x v t}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Denotes | prop v' == Denotes (tsubst x v t) (App _e v)
                     &amp;&amp; v' == app_den v d_txv
                     &amp;&amp; v' == dtev}</span><span class='hs-varid'>dtev</span></a>
<span class=hs-linenum>443: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>444: </span>        <a class=annot href="#"><span class=annottext>{v' : STLC.EvalsTo | prop v' == EvalsTo (App e v) (App e' v)}</span><span class='hs-varid'>p_ev_e'v</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; x3:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; {v : STLC.EvalsTo | prop v == EvalsTo (App x1 x3) (App x2 x3)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>lemma_app_many</span> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e'
                    &amp;&amp; v == p_ee'}</span><span class='hs-varid'>p_ee'</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>445: </span>        <a class=annot href="#"><span class=annottext>{v' : STLC.Denotes | prop v' == Denotes (tsubst x v t) (App _e v)
                     &amp;&amp; v' == app_den v d_txv}</span><span class='hs-varid'>dtev</span></a>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Denotes | prop v' == Denotes (tsubst x v t) (App _e v)
                     &amp;&amp; v' == app_den v d_txv}</span><span class='hs-varid'>app_den</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Denotes | v == d_txv}</span><span class='hs-varid'>d_txv</span></a> 
<span class=hs-linenum>446: </span><span class='hs-definition'>lemma1_fwd</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>p_ee'</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExists</span> <span class='hs-sel'>_x</span> <span class='hs-sel'>_tx</span> <span class='hs-sel'>_t</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>DExis</span> <span class='hs-varid'>x</span> <span class='hs-varid'>t_x</span> <span class='hs-varid'>t</span> <span class='hs-sel'>_e</span> <span class='hs-varid'>p_ebt</span> <span class='hs-varid'>v</span> <span class='hs-varid'>d_txv</span> <span class='hs-varid'>d_te</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Denotes | DExis##lqdc##$select v' == den_te'
                     &amp;&amp; DExis##lqdc##$select v' == d_txv
                     &amp;&amp; DExis v' == v
                     &amp;&amp; DExis##lqdc##$select v' == p_e'bt
                     &amp;&amp; DExis v' == e'
                     &amp;&amp; DExis v' == t
                     &amp;&amp; DExis v' == t_x
                     &amp;&amp; DExis v' == x
                     &amp;&amp; prop v' == Denotes (TExists x t_x t) e'
                     &amp;&amp; v' == DExis x t_x t e' p_e'bt v d_txv den_te'
                     &amp;&amp; v' == d_te'}</span><span class='hs-varid'>d_te'</span></a>
<span class=hs-linenum>447: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>448: </span>    <a class=annot href="#"><span class=annottext>{v' : STLC.Denotes | DExis##lqdc##$select v' == den_te'
                     &amp;&amp; DExis##lqdc##$select v' == d_txv
                     &amp;&amp; DExis v' == v
                     &amp;&amp; DExis##lqdc##$select v' == p_e'bt
                     &amp;&amp; DExis v' == e'
                     &amp;&amp; DExis v' == t
                     &amp;&amp; DExis v' == t_x
                     &amp;&amp; DExis v' == x
                     &amp;&amp; prop v' == Denotes (TExists x t_x t) e'
                     &amp;&amp; v' == DExis x t_x t e' p_e'bt v d_txv den_te'}</span><span class='hs-varid'>d_te'</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Denotes | DExis##lqdc##$select v' == den_te'
                     &amp;&amp; DExis##lqdc##$select v' == d_txv
                     &amp;&amp; DExis v' == v
                     &amp;&amp; DExis##lqdc##$select v' == p_e'bt
                     &amp;&amp; DExis v' == e'
                     &amp;&amp; DExis v' == t
                     &amp;&amp; DExis v' == t_x
                     &amp;&amp; DExis v' == x
                     &amp;&amp; prop v' == Denotes (TExists x t_x t) e'
                     &amp;&amp; v' == DExis x t_x t e' p_e'bt v d_txv den_te'}</span><span class='hs-conid'>DExis</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t_x}</span><span class='hs-varid'>t_x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.HasBType | v == p_e'bt}</span><span class='hs-varid'>p_e'bt</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | isValue v'
                  &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Denotes | prop v' == Denotes t_x v
                     &amp;&amp; v' == d_txv}</span><span class='hs-varid'>d_txv</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Denotes | v == den_te'}</span><span class='hs-varid'>den_te'</span></a>
<span class=hs-linenum>449: </span>    <a class=annot href="#"><span class=annottext>STLC.HasBType</span><span class='hs-varid'>p_e'bt</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>STLC.HasBType</span><span class='hs-varid'>lemma_soundness</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e'
                    &amp;&amp; v == p_ee'}</span><span class='hs-varid'>p_ee'</span></a> <a class=annot href="#"><span class=annottext>STLC.BType</span><span class='hs-layout'>(</span></a><span class='hs-varid'>erase</span> <a class=annot href="#"><span class=annottext>{v : STLC.Type | TExists##lqdc##$select v == t
                 &amp;&amp; TExists##lqdc##$select v == t_x
                 &amp;&amp; TExists##lqdc##$select v == x
                 &amp;&amp; tsize v == tsize t + 1
                 &amp;&amp; v == TExists x t_x t}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>TExists</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t_x}</span><span class='hs-varid'>t_x</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : STLC.HasBType | prop v == HasBType BEmpty _e (erase t)
                     &amp;&amp; v == p_ebt}</span><span class='hs-varid'>p_ebt</span></a>
<span class=hs-linenum>450: </span>    <a class=annot href="#"><span class=annottext>STLC.Denotes</span><span class='hs-varid'>den_te'</span></a>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; x4:STLC.Type -&gt; {v : STLC.Denotes | prop v == Denotes x4 x1} -&gt; {v : STLC.Denotes | prop v == Denotes x4 x2}</span><span class='hs-varid'>lemma1_fwd</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Expr | v == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.EvalsTo | prop v == EvalsTo e e'
                    &amp;&amp; v == p_ee'}</span><span class='hs-varid'>p_ee'</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Type | tsize v' &lt;= tsize t
                  &amp;&amp; tsize v' &gt;= 0
                  &amp;&amp; v' == tsubst x v t}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tsubst</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v' : STLC.Expr | isValue v'
                  &amp;&amp; v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : STLC.Type | v == t}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v' : STLC.Denotes | prop v' == Denotes (tsubst x v t) _e
                     &amp;&amp; v' == d_te}</span><span class='hs-varid'>d_te</span></a>
<span class=hs-linenum>451: </span>
<span class=hs-linenum>452: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>lemma1_bck</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e'</span><span class='hs-conop'>:</span><span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>EvalsTo</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>Type</span>
<span class=hs-linenum>453: </span>                   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-varid'>t</span> <span class='hs-varid'>e'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ProofOf</span><span class='hs-layout'>(</span><span class='hs-conid'>Denotes</span> <span class='hs-varid'>t</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>454: </span><span class='hs-definition'>lemma1_bck</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EvalsTo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Denotes</span>
<span class=hs-linenum>455: </span><a class=annot href="#"><span class=annottext>x1:STLC.Expr -&gt; x2:STLC.Expr -&gt; {v : STLC.EvalsTo | prop v == EvalsTo x1 x2} -&gt; x4:STLC.Type -&gt; {v : STLC.Denotes | prop v == Denotes x4 x2} -&gt; {v : STLC.Denotes | prop v == Denotes x4 x1}</span><span class='hs-definition'>lemma1_bck</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
</pre>
</body>
</html>